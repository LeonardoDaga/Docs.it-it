---
uid: signalr/overview/performance/signalr-connection-density-testing-with-crank
title: Densità di connessione di SignalR con Crank di test | Microsoft Docs
author: Rick-Anderson
description: Densità di connessione di SignalR con Crank di test
ms.author: riande
ms.date: 02/22/2015
ms.assetid: 148d9ca7-1af1-44b6-a9fb-91e261b9b463
msc.legacyurl: /signalr/overview/performance/signalr-connection-density-testing-with-crank
msc.type: authoredcontent
ms.openlocfilehash: 308fed51953b085506488c5e0dda1ced9f4d09fb
ms.sourcegitcommit: 74e3be25ea37b5fc8b4b433b0b872547b4b99186
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/12/2018
ms.locfileid: "53287573"
---
<a name="signalr-connection-density-testing-with-crank"></a><span data-ttu-id="e7d8d-103">Densità di connessione di SignalR con Crank di test</span><span class="sxs-lookup"><span data-stu-id="e7d8d-103">SignalR Connection Density Testing with Crank</span></span>
====================
<span data-ttu-id="e7d8d-104">da [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="e7d8d-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

> <span data-ttu-id="e7d8d-105">Questo articolo descrive come usare lo strumento manovella per testare un'applicazione con più client simulato.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-105">This article describes how to use the Crank tool to test an application with multiple simulated clients.</span></span>


<span data-ttu-id="e7d8d-106">L'applicazione è in esecuzione nel relativo ambiente di hosting (un Azure ruolo, IIS, web o reso indipendente utilizzando Owin), è possibile testare la risposta dell'applicazione a un elevato livello di densità di connessione mediante lo strumento di perno.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-106">Once your application is running in its hosting environment (either an Azure web role, IIS, or self-hosted using Owin), you can test application's response to a high level of connection density using the Crank tool.</span></span> <span data-ttu-id="e7d8d-107">L'ambiente di hosting può essere un server Internet Information Services (IIS), un host Owin o un ruolo web di Azure.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-107">The hosting environment can be an Internet Information Services (IIS) server, an Owin host, or an Azure web role.</span></span> <span data-ttu-id="e7d8d-108">(Nota: I contatori delle prestazioni non sono disponibili in App Web di servizio App di Azure, in modo non sarà in grado di ottenere i dati sulle prestazioni da un test di densità di connessione.)</span><span class="sxs-lookup"><span data-stu-id="e7d8d-108">(Note: Performance counters are not available on Azure App Service Web Apps, so you will not be able to get performance data from a connection density test.)</span></span>

<span data-ttu-id="e7d8d-109">Densità di connessione fa riferimento al numero di connessioni TCP simultanee che possono essere stabilite in un server.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-109">Connection Density refers to the number of simultaneous TCP connections that can be established on a server.</span></span> <span data-ttu-id="e7d8d-110">Ogni connessione TCP comporta il proprio sovraccarico e apertura di un numero elevato di connessioni inattive consentono di creare un collo di bottiglia della memoria.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-110">Each TCP connection incurs its own overhead, and opening a large number of idle connections will eventually create a memory bottleneck.</span></span>

<span data-ttu-id="e7d8d-111">[SignalR codebase](https://github.com/signalr/signalr) include uno strumento di test di carico denominato **Crank**.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-111">[The SignalR codebase](https://github.com/signalr/signalr) includes a load-testing tool called **Crank**.</span></span> <span data-ttu-id="e7d8d-112">La versione più recente del perno è reperibile nel [branch Dev](https://github.com/SignalR/signalr/tree/dev) su GitHub.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-112">The latest version of Crank can be found in [the Dev branch](https://github.com/SignalR/signalr/tree/dev) on GitHub.</span></span> <span data-ttu-id="e7d8d-113">È possibile scaricare un file Zip codebase archivio del ramo di sviluppo di SignalR [qui](https://github.com/SignalR/SignalR/archive/dev.zip).</span><span class="sxs-lookup"><span data-stu-id="e7d8d-113">You can download a Zip archive of the Dev branch of the SignalR codebase [here](https://github.com/SignalR/SignalR/archive/dev.zip).</span></span>

<span data-ttu-id="e7d8d-114">Crank consente completamente saturare la memoria del server per calcolare il numero totale di connessioni inattive in hardware del server.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-114">Crank may be used to fully saturate the server's memory in order to calculate the total number of idle connections possible on the server hardware.</span></span> <span data-ttu-id="e7d8d-115">In alternativa, si può anche usare manovella per test di carico il server in una certa quantità di richieste di memoria, da imparare le connessioni fino a quando non viene raggiunta una soglia di memoria specifico o un numero specifico.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-115">Alternatively, you may also use Crank to load test the server under a certain amount of memory pressure, by ramping up connections until a specific count or a specific memory threshold is reached.</span></span>

<span data-ttu-id="e7d8d-116">Durante il test, è importante usare client remoto per evitare qualsiasi concorrenza per le risorse (ad esempio, le connessioni TCP e memoria).</span><span class="sxs-lookup"><span data-stu-id="e7d8d-116">When testing, it is important to use remote client(s) to avoid any competition for resources (i.e., TCP connections and memory).</span></span> <span data-ttu-id="e7d8d-117">Monitorare i client per garantire che non si avvicinino eventuali colli di bottiglia che potrebbero impedire al server di raggiungere la piena capacità (memoria o CPU).</span><span class="sxs-lookup"><span data-stu-id="e7d8d-117">Monitor the client(s) to ensure that they are not hitting any bottlenecks that may prevent the server from reaching its full capacity (memory or CPU).</span></span> <span data-ttu-id="e7d8d-118">Si potrebbe essere necessario aumentare il numero di client per caricare completamente i server.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-118">You may need to increase the number of clients in order to fully load the server.</span></span>

### <a name="running-a-connection-density-test"></a><span data-ttu-id="e7d8d-119">Esecuzione di un Test di densità di connessione</span><span class="sxs-lookup"><span data-stu-id="e7d8d-119">Running a Connection Density Test</span></span>

<span data-ttu-id="e7d8d-120">Questa sezione descrive i passaggi necessari per eseguire un test di densità di connessione in un'applicazione di SignalR.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-120">This section describes the steps needed to run a connection density test on a SignalR application.</span></span>

1. <span data-ttu-id="e7d8d-121">Scaricare e compilare il [branch Dev di SignalR codebase](https://github.com/SignalR/SignalR/archive/dev.zip).</span><span class="sxs-lookup"><span data-stu-id="e7d8d-121">Download and build the [Dev branch of the SignalR codebase](https://github.com/SignalR/SignalR/archive/dev.zip).</span></span> <span data-ttu-id="e7d8d-122">In un prompt dei comandi, passare a &lt;directory di progetto&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-122">In a command prompt, navigate to &lt;project directory&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.</span></span>
2. <span data-ttu-id="e7d8d-123">Distribuire l'applicazione per l'ambiente di hosting desiderata.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-123">Deploy your application to its intended hosting environment.</span></span> <span data-ttu-id="e7d8d-124">Prendere nota dell'endpoint utilizzati dall'applicazione; ad esempio, nell'applicazione creata nel [esercitazione introduttiva](../getting-started/tutorial-getting-started-with-signalr.md), l'endpoint è `http://<yourhost>:8080/signalr`.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-124">Make a note of the endpoint that your application uses; for example, in the application created in the [Getting Started tutorial](../getting-started/tutorial-getting-started-with-signalr.md), the endpoint is `http://<yourhost>:8080/signalr`.</span></span>
3. <span data-ttu-id="e7d8d-125">Installare [contatori delle prestazioni di SignalR](signalr-performance.md#perfcounters) nel server.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-125">Install [SignalR performance counters](signalr-performance.md#perfcounters) on the server.</span></span> <span data-ttu-id="e7d8d-126">Se l'applicazione è in esecuzione in Azure, vedere [utilizzo di contatori delle prestazioni di SignalR in un ruolo Web Azure](using-signalr-performance-counters-in-an-azure-web-role.md).</span><span class="sxs-lookup"><span data-stu-id="e7d8d-126">If your application is running on Azure, see [Using SignalR Performance Counters in an Azure Web Role](using-signalr-performance-counters-in-an-azure-web-role.md).</span></span>

<span data-ttu-id="e7d8d-127">Dopo aver scaricato e compilato la codebase e installato i contatori delle prestazioni nell'host, lo strumento da riga di comando di perno è reperibile nella `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` cartella.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-127">Once you've downloaded and built the codebase, and installed performance counters on your host, the Crank command-line tool can be found in the `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` folder.</span></span>

<span data-ttu-id="e7d8d-128">Le opzioni disponibili per lo strumento Crank includono:</span><span class="sxs-lookup"><span data-stu-id="e7d8d-128">Available options for the Crank tool include:</span></span>

- <span data-ttu-id="e7d8d-129">**/?** : Mostra la schermata della Guida.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-129">**/?**: Shows the help screen.</span></span> <span data-ttu-id="e7d8d-130">Le opzioni disponibili vengono visualizzate anche se il **Url** parametro viene omesso.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-130">The available options are also displayed if the **Url** parameter is omitted.</span></span>
- <span data-ttu-id="e7d8d-131">**/ Url**: L'URL per le connessioni SignalR.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-131">**/Url**: The URL for SignalR connections.</span></span> <span data-ttu-id="e7d8d-132">Questo parametro è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-132">This parameter is required.</span></span> <span data-ttu-id="e7d8d-133">Per un'applicazione di SignalR con il mapping predefinito, il percorso termina "/ signalr".</span><span class="sxs-lookup"><span data-stu-id="e7d8d-133">For a SignalR application using the default mapping, the path will end in "/signalr".</span></span>
- <span data-ttu-id="e7d8d-134">**/ Trasporto**: Il nome del trasporto utilizzato.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-134">**/Transport**: The name of the transport used.</span></span> <span data-ttu-id="e7d8d-135">Il valore predefinito è `auto`, che verrà selezionato il protocollo ottimale.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-135">The default is `auto`, which will select the best available protocol.</span></span> <span data-ttu-id="e7d8d-136">Le opzioni includono `WebSockets`, `ServerSentEvents`, e `LongPolling` (`ForeverFrame` non è un'opzione per manovella, poiché il client .NET invece viene utilizzato Internet Explorer).</span><span class="sxs-lookup"><span data-stu-id="e7d8d-136">Options include `WebSockets`, `ServerSentEvents`, and `LongPolling` (`ForeverFrame` is not an option for Crank, since the .NET client rather than Internet Explorer is used).</span></span> <span data-ttu-id="e7d8d-137">Per altre informazioni su come SignalR seleziona trasporti, vedere [trasporti e i fallback](../getting-started/introduction-to-signalr.md#transports).</span><span class="sxs-lookup"><span data-stu-id="e7d8d-137">For more information on how SignalR selects transports, see [Transports and Fallbacks](../getting-started/introduction-to-signalr.md#transports).</span></span>
- <span data-ttu-id="e7d8d-138">**/ BatchSize**: Il numero di client aggiunti in ogni batch.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-138">**/BatchSize**: The number of clients added in each batch.</span></span> <span data-ttu-id="e7d8d-139">Il valore predefinito è 50.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-139">The default is 50.</span></span>
- <span data-ttu-id="e7d8d-140">**/ ConnectInterval**: L'intervallo in millisecondi tra l'aggiunta di connessioni.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-140">**/ConnectInterval**: The interval in milliseconds between adding connections.</span></span> <span data-ttu-id="e7d8d-141">Il valore predefinito è 500.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-141">The default is 500.</span></span>
- <span data-ttu-id="e7d8d-142">**/ Connessioni**: Il numero di connessioni utilizzato per l'applicazione di test di carico.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-142">**/Connections**: The number of connections used to load-test the application.</span></span> <span data-ttu-id="e7d8d-143">Il valore predefinito è 100.000.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-143">The default is 100,000.</span></span>
- <span data-ttu-id="e7d8d-144">**/ ConnectTimeout**: Il timeout in secondi prima di interrompere il test.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-144">**/ConnectTimeout**: The timeout in seconds before aborting the test.</span></span> <span data-ttu-id="e7d8d-145">Il valore predefinito è 300.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-145">The default is 300.</span></span>
- <span data-ttu-id="e7d8d-146">**MinServerMBytes**: I megabyte minima per il server di raggiungere.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-146">**MinServerMBytes**: The minimum server megabytes to reach.</span></span> <span data-ttu-id="e7d8d-147">Il valore predefinito è 500.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-147">The default is 500.</span></span>
- <span data-ttu-id="e7d8d-148">**SendBytes**: Le dimensioni del payload inviato al server in byte.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-148">**SendBytes**: The size of the payload sent to the server in bytes.</span></span> <span data-ttu-id="e7d8d-149">Il valore predefinito è 0.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-149">The default is 0.</span></span>
- <span data-ttu-id="e7d8d-150">**SendInterval**: Il ritardo in millisecondi tra i messaggi al server.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-150">**SendInterval**: The delay in milliseconds between messages to the server.</span></span> <span data-ttu-id="e7d8d-151">Il valore predefinito è 500.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-151">The default is 500.</span></span>
- <span data-ttu-id="e7d8d-152">**SendTimeout**: Il timeout in millisecondi per i messaggi al server.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-152">**SendTimeout**: The timeout in milliseconds for messages to the server.</span></span> <span data-ttu-id="e7d8d-153">Il valore predefinito è 300.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-153">The default is 300.</span></span>
- <span data-ttu-id="e7d8d-154">**ControllerUrl**: L'Url in cui un client ospiterà un hub di controller.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-154">**ControllerUrl**: The Url where one client will host a controller hub.</span></span> <span data-ttu-id="e7d8d-155">Il valore predefinito è null (Nessun hub controller).</span><span class="sxs-lookup"><span data-stu-id="e7d8d-155">The default is null (no controller hub).</span></span> <span data-ttu-id="e7d8d-156">L'hub di controller viene avviato all'avvio della sessione Crank; alcuna ulteriore contatto tra l'hub di controller e Crank viene usato.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-156">The controller hub is started when the Crank session starts; no further contact between the controller hub and Crank is made.</span></span>
- <span data-ttu-id="e7d8d-157">**NumClients**: Il numero di client simulato per connettersi all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-157">**NumClients**: The number of simulated clients to connect to the application.</span></span> <span data-ttu-id="e7d8d-158">Il valore predefinito è uno.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-158">The default is one.</span></span>
- <span data-ttu-id="e7d8d-159">**File di log**: Il nome del file per il file di log per l'esecuzione dei test.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-159">**Logfile**: The filename for the logfile for the test run.</span></span> <span data-ttu-id="e7d8d-160">Il valore predefinito è `crank.csv`.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-160">The default is `crank.csv`.</span></span>
- <span data-ttu-id="e7d8d-161">**SampleInterval**: Il tempo in millisecondi tra i campioni di contatore delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-161">**SampleInterval**: The time in milliseconds between performance counter samples.</span></span> <span data-ttu-id="e7d8d-162">Il valore predefinito è 1000.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-162">The default is 1000.</span></span>
- <span data-ttu-id="e7d8d-163">**SignalRInstance**: Il nome dell'istanza per i contatori delle prestazioni nel server.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-163">**SignalRInstance**: The instance name for the performance counters on the server.</span></span> <span data-ttu-id="e7d8d-164">L'impostazione predefinita consiste nell'usare lo stato della connessione client.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-164">The default is to use the client connection state.</span></span>

### <a name="example"></a><span data-ttu-id="e7d8d-165">Esempio</span><span class="sxs-lookup"><span data-stu-id="e7d8d-165">Example</span></span>

<span data-ttu-id="e7d8d-166">Il comando seguente eseguirà il test un sito denominato `pfsignalr` di Azure che ospita un'applicazione sulla porta 8080 con un hub denominato "ControllerHub", utilizzando 100 connessioni.</span><span class="sxs-lookup"><span data-stu-id="e7d8d-166">The following command will test a site called `pfsignalr` on Azure that hosts an application on port 8080 with a hub named "ControllerHub", using 100 connections.</span></span>

`crank /Connections:100 /Url:http://pfsignalr.cloudapp.net:8080/signalr`
